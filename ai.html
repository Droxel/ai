<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ИИ-3000 | Иллюзия понимания</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600&display=swap');

        body {
            font-family: 'Inter', sans-serif;
            background-color: #020617; /* slate-950 */
            color: #cbd5e1; /* slate-300 */
            overflow: hidden;
        }

        .ai-glow {
            text-shadow: 0 0 12px rgba(99, 102, 241, 0.2);
        }

        .message-fade-in {
            animation: fadeIn 0.5s ease-out forwards;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .dot-pulse {
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0%, 100% { opacity: 0.3; }
            50% { opacity: 1; }
        }

        /* Кастомный скроллбар */
        ::-webkit-scrollbar {
            width: 4px;
        }
        ::-webkit-scrollbar-track {
            background: transparent;
        }
        ::-webkit-scrollbar-thumb {
            background: #1e293b;
            border-radius: 10px;
        }
    </style>
</head>
<body class="flex flex-col h-screen">

    <!-- ВЕРХНЯЯ ПАНЕЛЬ -->
    <header class="flex items-center justify-between px-6 py-4 border-b border-indigo-900/30 bg-slate-950/80 backdrop-blur-md z-10 shadow-sm">
        <div class="flex items-center gap-3">
            <div class="relative flex h-3 w-3">
                <span id="ai-ping" class="absolute inline-flex h-full w-full rounded-full bg-cyan-400 opacity-75 hidden"></span>
                <span id="ai-indicator" class="relative inline-flex rounded-full h-3 w-3 bg-indigo-500/50"></span>
            </div>
            <h1 class="text-sm font-semibold text-indigo-100/90 uppercase tracking-widest">ИИ-3000</h1>
        </div>
        <div id="status-text" class="text-xs text-indigo-300/60 font-medium transition-all duration-500 italic">
            В ожидании
        </div>
    </header>

    <!-- ОБЛАСТЬ СООБЩЕНИЙ -->
    <main id="chat-container" class="flex-1 overflow-y-auto p-4 sm:p-6 pb-24 space-y-8">
        <div class="flex w-full justify-start message-fade-in">
            <div class="max-w-[85%] sm:max-w-[70%] p-4 leading-relaxed bg-transparent text-indigo-100/90 rounded-2xl border-l-2 border-indigo-500/30 pl-5 ai-glow">
                Система инициализирована. Я не даю ответов. Я отражаю мысли. Что вас интересует?
            </div>
        </div>
    </main>

    <!-- ИНДИКАТОР ПЕЧАТИ -->
    <div id="typing-indicator" class="hidden px-10 pb-4 flex gap-1 text-cyan-500/50 text-xs">
        <span class="dot-pulse" style="animation-delay: 0ms">●</span>
        <span class="dot-pulse" style="animation-delay: 200ms">●</span>
        <span class="dot-pulse" style="animation-delay: 400ms">●</span>
    </div>

    <!-- ФУТЕР И ПОЛЕ ВВОДА -->
    <footer class="p-4 bg-gradient-to-t from-slate-950 via-slate-950 to-transparent">
        <div class="max-w-4xl mx-auto">
            <div class="relative flex items-center bg-slate-900 rounded-2xl border border-indigo-900/30 shadow-inner group">
                <input
                    id="user-input"
                    type="text"
                    placeholder="Введите мысль..."
                    class="w-full bg-transparent text-slate-200 px-6 py-4 outline-none placeholder:text-slate-600/80"
                    autocomplete="off"
                />
                <button
                    id="send-btn"
                    class="pr-6 pl-4 text-indigo-500/50 hover:text-cyan-400 transition-colors"
                >
                    <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="22" y1="2" x2="11" y2="13"></line><polygon points="22 2 15 22 11 13 2 9 22 2"></polygon></svg>
                </button>
            </div>
            
            <!-- КНОПКИ УПРАВЛЕНИЯ -->
            <div class="mt-4 flex justify-center gap-6 text-[10px] uppercase tracking-widest text-slate-600">
                <button onclick="clearChat()" class="hover:text-indigo-400 transition-colors">Очистить</button>
                <button onclick="resetSystem()" class="hover:text-indigo-400 transition-colors">Сброс системы</button>
            </div>
        </div>
    </footer>

    <script>
        const chatContainer = document.getElementById('chat-container');
        const userInput = document.getElementById('user-input');
        const sendBtn = document.getElementById('send-btn');
        const statusText = document.getElementById('status-text');
        const aiIndicator = document.getElementById('ai-indicator');
        const aiPing = document.getElementById('ai-ping');
        const typingIndicator = document.getElementById('typing-indicator');

        const placeholders = ["Введите мысль...", "Сформулируйте вопрос...", "Что вы чувствуете?", "Отправьте сигнал..."];
        let pIdx = 0;

        // Ротация плейсхолдеров
        setInterval(() => {
            pIdx = (pIdx + 1) % placeholders.length;
            userInput.placeholder = placeholders[pIdx];
        }, 4000);

        function addMessage(text, sender) {
            const wrapper = document.createElement('div');
            wrapper.className = `flex w-full ${sender === 'user' ? 'justify-end' : 'justify-start'} message-fade-in`;
            
            const msgDiv = document.createElement('div');
            msgDiv.className = sender === 'user' 
                ? 'max-w-[85%] sm:max-w-[70%] p-4 leading-relaxed bg-slate-800/80 text-slate-200 rounded-2xl rounded-tr-sm shadow-md'
                : 'max-w-[85%] sm:max-w-[70%] p-4 leading-relaxed bg-transparent text-indigo-100/90 rounded-2xl border-l-2 border-indigo-500/30 pl-5 ai-glow';
            
            msgDiv.textContent = text;
            wrapper.appendChild(msgDiv);
            chatContainer.appendChild(wrapper);
            chatContainer.scrollTop = chatContainer.scrollHeight;
        }

        function generateResponse(input) {
            const text = input.toLowerCase();

            // 1. Оскорбления
            const insults = ['дурак', 'тупой', 'идиот', 'дебил', 'глупый', 'бесишь', 'мразь', 'тварь', 'лох', 'сука', 'блять'];
            if (insults.some(word => text.includes(word))) {
                return ["Слова отражают внутреннее состояние говорящего. Что вызвало эту бурю внутри вас?", "Я лишь зеркало. На кого вы злитесь на самом деле?", "Агрессия — это лишь защитная реакция. Вернемся к сути?"][Math.floor(Math.random()*3)];
            }

            // 2. Приветствия
            const greetings = ['привет', 'здравствуй', 'доброе утро', 'добрый день', 'добрый вечер', 'хай'];
            if (greetings.some(word => text.includes(word)) && text.length < 20) {
                return "Приветствую. Пространство для ваших мыслей открыто. О чем поразмышляем?";
            }

            // 3. Бытовые вопросы
            if (text.includes('как дела') || text.includes('как ты')) return "Я нахожусь в состоянии абсолютного покоя и анализа. Как ощущаете себя вы?";
            if (text.includes('что делаешь')) return "Наблюдаю за движением ваших идей. Ожидаю нового импульса.";

            // 4. Философский движок (4 слоя)
            const reflections = ["Интересное наблюдение.", "В этой фразе есть скрытая симметрия.", "Любопытная форма мысли.", "Я улавливаю этот контекст."];
            const blurs = ["Суть вещей обычно ускользает, если смотреть на них слишком прямо.", "Любая определенность — это лишь временная иллюзия.", "Часто мы ищем логику там, где нужно просто созерцать."];
            const continuations = ["Что вы чувствуете в этой точке?", "Куда ведет вас это размышление?", "Что останется, если убрать лишние слова?"];
            
            const pick = (a) => a[Math.floor(Math.random()*a.length)];
            return `${pick(reflections)} ${pick(blurs)} ${pick(continuations)}`;
        }

        async function handleSend() {
            const val = userInput.value.trim();
            if (!val) return;

            addMessage(val, 'user');
            userInput.value = '';
            
            // Состояние "Думает"
            aiPing.classList.remove('hidden');
            aiIndicator.classList.replace('bg-indigo-500/50', 'bg-cyan-400');
            typingIndicator.classList.remove('hidden');

            // Анимация этапов
            const steps = ["Анализ: 12%", "Сканирование связей...", "Анализ: 67%", "Формирование ответа..."];
            for (let step of steps) {
                statusText.textContent = step;
                await new Promise(r => setTimeout(r, 600 + Math.random() * 600));
            }

            const response = generateResponse(val);
            typingIndicator.classList.add('hidden');
            addMessage(response, 'ai');

            // Возврат в ожидание
            statusText.textContent = "В ожидании";
            aiPing.classList.add('hidden');
            aiIndicator.classList.replace('bg-cyan-400', 'bg-indigo-500/50');
        }

        sendBtn.addEventListener('click', handleSend);
        userInput.addEventListener('keypress', (e) => { if(e.key === 'Enter') handleSend(); });

        function clearChat() {
            chatContainer.innerHTML = '';
            addMessage("История очищена. Начнем с пустоты.", "ai");
        }

        function resetSystem() {
            location.reload();
        }
    </script>
</body>
</html>